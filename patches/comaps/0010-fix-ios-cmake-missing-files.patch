diff --git a/libs/platform/CMakeLists.txt b/libs/platform/CMakeLists.txt
index c26e864b..bc9a812d 100644
--- a/libs/platform/CMakeLists.txt
+++ b/libs/platform/CMakeLists.txt
@@ -72,7 +72,7 @@ if (PLATFORM_IPHONE)
     http_thread_apple.mm
     http_client_apple.mm
     http_uploader_apple.mm
-    http_user_agent_ios.mm
+    http_session_manager.mm
     localization.mm
     locale.mm
     network_policy_ios.h
@@ -83,14 +83,46 @@ if (PLATFORM_IPHONE)
     secure_storage_ios.mm
     socket_apple.mm
   )
+elseif(SKIP_ANDROID_JNI AND ${PLATFORM_ANDROID})
+  # Android build without JNI (for Flutter plugin with external platform impl)
+  # Note: Platform::GetReader etc. is provided by external code (agus_platform.cpp)
+  append(SRC
+    platform_unix_impl.cpp
+    platform_unix_impl.hpp
+    http_client_curl.cpp
+    http_uploader_background_dummy.cpp
+    localization_dummy.cpp
+    network_policy_dummy.cpp
+    secure_storage_dummy.cpp
+  )
 elseif(${PLATFORM_ANDROID})
+  # Standard Android build with JNI and APK asset reader
   append(SRC
     platform_android.cpp
     platform_unix_impl.cpp
     platform_unix_impl.hpp
     trace_android.cpp
   )
-else() # neither iPhone nor Android
+elseif(SKIP_QT AND ${PLATFORM_MAC})
+  # macOS build without Qt (for Flutter plugin)
+  append(SRC
+    gui_thread_apple.mm
+    http_client_apple.mm
+    http_thread_apple.h
+    http_thread_apple.mm
+    http_uploader_apple.mm
+    http_uploader_background_dummy.cpp
+    locale.mm
+    localization_dummy.cpp
+    network_policy_dummy.cpp
+    platform_mac.mm
+    platform_unix_impl.cpp
+    platform_unix_impl.hpp
+    secure_storage_dummy.cpp
+    socket_apple.mm
+    http_session_manager.mm
+  )
+else() # Desktop with Qt (Linux, Windows, macOS Qt app)
   # Find bash first, on Windows it can be either in Git or in WSL
   find_program(BASH bash REQUIRED HINTS "$ENV{ProgramFiles}/Git/bin")
   # Generate version header file.
@@ -175,9 +207,9 @@ endif()
 target_link_libraries(${PROJECT_NAME}
   geometry  # mercator::YToLat
   coding
-  $<$<BOOL:${PLATFORM_DESKTOP}>:Qt6::Core>
-  $<$<BOOL:${PLATFORM_LINUX}>:Qt6::Network>
-  $<$<BOOL:${PLATFORM_WIN}>:Qt6::Network>
+  $<$<AND:$<BOOL:${PLATFORM_DESKTOP}>,$<NOT:$<BOOL:${SKIP_QT}>>>:Qt6::Core>
+  $<$<AND:$<BOOL:${PLATFORM_LINUX}>,$<NOT:$<BOOL:${SKIP_QT}>>>:Qt6::Network>
+  $<$<AND:$<BOOL:${PLATFORM_WIN}>,$<NOT:$<BOOL:${SKIP_QT}>>>:Qt6::Network>
   $<$<BOOL:${PLATFORM_WIN}>:shlwapi>  # PathIsDirectoryEmptyA
   $<$<BOOL:${PLATFORM_MAC}>:
     -framework\ Foundation
